import{DynamicScript,theme,wallet,price,network,cookies,Modal,api}from"./utils.js";new DynamicScript("https://kit.fontawesome.com/c1a16f97ec.js"),theme.load(),document.querySelector("#theme").addEventListener("click",()=>theme.toggle());const obj=document.querySelector("#network-btn");obj.classList.add(network.symbol),obj.querySelector(".name").innerHTML=network.name,obj.querySelector(".icon").src=`img/${network.symbol}.png`,obj.addEventListener("click",(function(){const dropdown=document.createElement("div");dropdown.id="dropdown",dropdown.innerHTML=Object.entries(networks).map(([k,v])=>`<div id="${k}" class="item"><a href="/${k}"><img class="icon" src="img/${k}.png"><span class="name">${v.name}</span></a></div>`).join(""),dropdown.style.top=`${this.offsetTop+this.clientHeight}px`,dropdown.style.left=`${this.offsetLeft+this.clientWidth-130}px`;const fog=document.createElement("div");fog.id="fog",fog.classList.add("invisible"),document.body.appendChild(fog),fog.appendChild(dropdown),fog.addEventListener("click",()=>fog.remove())})),document.querySelectorAll(".token-name").forEach(e=>e.innerHTML=network.token),document.querySelectorAll(".chain-symbol").forEach(e=>e.innerHTML=network.symbol),document.querySelectorAll(".chain-name").forEach(e=>e.innerHTML=network.name),price.token=network.token,price.update(),setInterval(()=>price.update(),1e4);const explorer=document.querySelector("footer .resources #explorer");explorer.href=network.explorer.href,explorer.querySelector("img").src=network.explorer.icon,explorer.querySelector(".name").innerHTML=network.explorer.name,wallet.loadImg(document.querySelector("#donate"),network),document.querySelectorAll(".donate-link").forEach(e=>wallet.bindModal(e,network));const session={get:function(){return cookies.get("session")},set:function(id){cookies.set("session",id,{expires:{hours:1}})},delete:function(){cookies.delete("session")},validate:async function(password){let body={password:password};if(!password&&(body={currentSession:this.get()},!this.get()))return!1;const data=await api.request("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)});return data.error?(this.delete(),data):(this.set(data.sessionId),data)},login:async function(){const buttonPress=async modal=>{const value=modal.domObject.querySelector("input").value.trim();if(value.length>0){const button=modal.domObject.querySelector("button");button.innerHTML='<i class="fas fa-spin fa-cog"></i>',button.setAttribute("disabled",!0),modal.domObject.querySelector("input").setAttribute("disabled",!0);const data=await this.validate(value);if(data.error)return void new Modal(`<h2>${data.error}</h2>\n                        <p>${data.message}</p>\n                        <div id="button-container"><button id="close">OK</button></div>`,{fog:{dark:!0}}).addEvent({tag:"button",event:"click",callback:()=>this.login()});this.set(data.sessionId),modal.close(),this.loaded=!0}},modal=new Modal('<h2>Admin Login</h2>\n            <div class="input-container">\n                <input class="input-text" type="password">\n                <button class="input-button"><i class="fas fa-sign-in-alt"></i></button>\n            </div>\n        ',{id:"admin-login",fog:{close:!1,dark:!0}});modal.addEvent({tag:"button",event:"click",callback:()=>buttonPress(modal)}),modal.addEvent({class:"input-text",event:"keyup",callback:e=>{"Enter"==e.key&&buttonPress(modal)}})},check:async function(){const data=await this.validate();return!data||data.error?(this.delete(),this.login(),await new Promise(resolve=>{const monitor=()=>{this.loaded?resolve(!0):setTimeout(()=>monitor(),100)};monitor()})):(this.set(data.sessionId),!0)}};session.check().then(data=>{console.log(data)});
//# sourceMappingURL=admin.min.js.map